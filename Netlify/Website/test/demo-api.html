<!doctype html>
<html lang="en">
<head>
<style>
    .float-right {
        float: right;
    }
    dialog {
        border-radius: 1em;
    }
    dialog::backdrop {
        background-color: #0008;
    }
</style>
<script src="https://cdn.jsdelivr.net/npm/axios@1.3.4/dist/axios.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/ag-grid-community/dist/ag-grid-community.min.js"></script>
</head>
<body>
    Sample code for calling api to get data, click this:
    <button onclick="get_collections()">collections</button>
    <div id="topdiv" class="ag-theme-quartz" style="height: 45vh">this is the top</div>
    <div id="bottomdiv" class="ag-theme-quartz" style="height: 45vh">this is the bottom</div>

<script>

//=============================
// Global data
let api = '//db.fingerson.com';
let config = { withCredentials: true, headers: { Authorization: 'Bearer ???'}};
let cred = { email: 'api2@fingerson.com', password: '????'};

// TODO -- save this in the localStorage for convenience?
cred.password = prompt('Password for ' + cred.email);

axios.post(api+'/auth/login', cred).then(res => {
    console.log (res.data.data);
    config.headers.Authorization = 'Bearer ' + res.data.data.access_token;
},err => {
    console.log('login failed',err);
});

async function get_collections() {
    res = await axios.get(api+'/collections', config);
    let rowData = res.data.data;
    // filter and flatten the rows
    rowData = rowData.filter(r => !r.collection.startsWith('directus_')).map(r => {
        return { 
            collection: r.collection,
            action: r.collection,
            sql: r.schema.sql
        }
    });
    let columnDefs = [
        { field: 'collection' },
        { field: 'action', cellRenderer: v => `<span onclick="get_table('${v.value}')">⤵️</span>` },
        { field: 'sql' }
    ];
    let gridOptions = { rowData, columnDefs };
    let myGridElement = document.getElementById('topdiv');
    myGridElement.innerHTML = '';
    agGrid.createGrid(myGridElement, gridOptions);
}

`
stay_id
user_created
date_created
user_updated
date_updated
guest_id
bed_id
checkin_date


<div class="ag-header-row ag-header-row-column" role="row" aria-rowindex="1" style="top: 0px; height: 48px; width: 1800px;"><div class="ag-header-cell ag-column-first ag-header-cell-sortable ag-focus-managed" role="columnheader" col-id="stay_id" aria-colindex="1" tabindex="-1" aria-sort="none" style="top: 0px; height: 48px; width: 200px; left: 0px;">
            <div ref="eResize" class="ag-header-cell-resize" role="presentation" aria-hidden="false"></div><div role="presentation" class="ag-labeled ag-label-align-right ag-checkbox ag-input-field ag-header-select-all ag-hidden" aria-hidden="true">
                <div ref="eLabel" class="ag-input-field-label ag-label ag-hidden ag-checkbox-label" aria-hidden="true" role="presentation" id="ag-109-label"></div>
                <div ref="eWrapper" class="ag-wrapper ag-input-wrapper ag-checkbox-input-wrapper" role="presentation">
                    <input ref="eInput" class="ag-input-field-input ag-checkbox-input" type="checkbox" id="ag-109-input" tabindex="-1" aria-label="Press Space to toggle all rows selection (unchecked)">
                </div>
            </div>
            <div ref="eHeaderCompWrapper" class="ag-header-cell-comp-wrapper" role="presentation"><div class="ag-cell-label-container ag-header-cell-sorted-none" role="presentation">
            
            
            <div ref="eLabel" class="ag-header-cell-label" role="presentation">
                <span ref="eText" class="ag-header-cell-text">Stay_id</span>
                <span ref="eFilter" class="ag-header-icon ag-header-label-icon ag-filter-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-filter" unselectable="on" role="presentation"></span></span>
                <!--AG-SORT-INDICATOR--><span class="ag-sort-indicator-container" ref="eSortIndicator">
            <span ref="eSortOrder" class="ag-sort-indicator-icon ag-sort-order ag-hidden" aria-hidden="true"></span>
            <span ref="eSortAsc" class="ag-sort-indicator-icon ag-sort-ascending-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-asc" unselectable="on" role="presentation"></span></span>
            <span ref="eSortDesc" class="ag-sort-indicator-icon ag-sort-descending-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-desc" unselectable="on" role="presentation"></span></span>
            <span ref="eSortMixed" class="ag-sort-indicator-icon ag-sort-mixed-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-none" unselectable="on" role="presentation"></span></span>
            <span ref="eSortNone" class="ag-sort-indicator-icon ag-sort-none-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-none" unselectable="on" role="presentation"></span></span>
        </span>
            </div>
        </div></div>
        </div><div class="ag-header-cell ag-header-cell-sortable ag-focus-managed" role="columnheader" col-id="user_created" aria-colindex="2" tabindex="-1" aria-sort="none" style="top: 0px; height: 48px; width: 200px; left: 200px;">
            <div ref="eResize" class="ag-header-cell-resize" role="presentation" aria-hidden="false"></div><div role="presentation" class="ag-labeled ag-label-align-right ag-checkbox ag-input-field ag-header-select-all ag-hidden" aria-hidden="true">
                <div ref="eLabel" class="ag-input-field-label ag-label ag-hidden ag-checkbox-label" aria-hidden="true" role="presentation" id="ag-113-label"></div>
                <div ref="eWrapper" class="ag-wrapper ag-input-wrapper ag-checkbox-input-wrapper" role="presentation">
                    <input ref="eInput" class="ag-input-field-input ag-checkbox-input" type="checkbox" id="ag-113-input" tabindex="-1" aria-label="Press Space to toggle all rows selection (unchecked)">
                </div>
            </div>
            <div ref="eHeaderCompWrapper" class="ag-header-cell-comp-wrapper" role="presentation"><div class="ag-cell-label-container ag-header-cell-sorted-none" role="presentation">
            
            
            <div ref="eLabel" class="ag-header-cell-label" role="presentation">
                <span ref="eText" class="ag-header-cell-text">User_created</span>
                <span ref="eFilter" class="ag-header-icon ag-header-label-icon ag-filter-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-filter" unselectable="on" role="presentation"></span></span>
                <!--AG-SORT-INDICATOR--><span class="ag-sort-indicator-container" ref="eSortIndicator">
            <span ref="eSortOrder" class="ag-sort-indicator-icon ag-sort-order ag-hidden" aria-hidden="true"></span>
            <span ref="eSortAsc" class="ag-sort-indicator-icon ag-sort-ascending-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-asc" unselectable="on" role="presentation"></span></span>
            <span ref="eSortDesc" class="ag-sort-indicator-icon ag-sort-descending-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-desc" unselectable="on" role="presentation"></span></span>
            <span ref="eSortMixed" class="ag-sort-indicator-icon ag-sort-mixed-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-none" unselectable="on" role="presentation"></span></span>
            <span ref="eSortNone" class="ag-sort-indicator-icon ag-sort-none-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-none" unselectable="on" role="presentation"></span></span>
        </span>
            </div>
        </div></div>
        </div><div class="ag-header-cell ag-header-cell-sortable ag-focus-managed" role="columnheader" col-id="date_created" aria-colindex="3" tabindex="-1" aria-sort="none" style="top: 0px; height: 48px; width: 200px; left: 400px;">
            <div ref="eResize" class="ag-header-cell-resize" role="presentation" aria-hidden="false"></div><div role="presentation" class="ag-labeled ag-label-align-right ag-checkbox ag-input-field ag-header-select-all ag-hidden" aria-hidden="true">
                <div ref="eLabel" class="ag-input-field-label ag-label ag-hidden ag-checkbox-label" aria-hidden="true" role="presentation" id="ag-117-label"></div>
                <div ref="eWrapper" class="ag-wrapper ag-input-wrapper ag-checkbox-input-wrapper" role="presentation">
                    <input ref="eInput" class="ag-input-field-input ag-checkbox-input" type="checkbox" id="ag-117-input" tabindex="-1" aria-label="Press Space to toggle all rows selection (unchecked)">
                </div>
            </div>
            <div ref="eHeaderCompWrapper" class="ag-header-cell-comp-wrapper" role="presentation"><div class="ag-cell-label-container ag-header-cell-sorted-none" role="presentation">
            
            
            <div ref="eLabel" class="ag-header-cell-label" role="presentation">
                <span ref="eText" class="ag-header-cell-text">Date_created</span>
                <span ref="eFilter" class="ag-header-icon ag-header-label-icon ag-filter-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-filter" unselectable="on" role="presentation"></span></span>
                <!--AG-SORT-INDICATOR--><span class="ag-sort-indicator-container" ref="eSortIndicator">
            <span ref="eSortOrder" class="ag-sort-indicator-icon ag-sort-order ag-hidden" aria-hidden="true"></span>
            <span ref="eSortAsc" class="ag-sort-indicator-icon ag-sort-ascending-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-asc" unselectable="on" role="presentation"></span></span>
            <span ref="eSortDesc" class="ag-sort-indicator-icon ag-sort-descending-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-desc" unselectable="on" role="presentation"></span></span>
            <span ref="eSortMixed" class="ag-sort-indicator-icon ag-sort-mixed-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-none" unselectable="on" role="presentation"></span></span>
            <span ref="eSortNone" class="ag-sort-indicator-icon ag-sort-none-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-none" unselectable="on" role="presentation"></span></span>
        </span>
            </div>
        </div></div>
        </div><div class="ag-header-cell ag-header-cell-sortable ag-focus-managed" role="columnheader" col-id="user_updated" aria-colindex="4" tabindex="-1" aria-sort="none" style="top: 0px; height: 48px; width: 200px; left: 600px;">
            <div ref="eResize" class="ag-header-cell-resize" role="presentation" aria-hidden="false"></div><div role="presentation" class="ag-labeled ag-label-align-right ag-checkbox ag-input-field ag-header-select-all ag-hidden" aria-hidden="true">
                <div ref="eLabel" class="ag-input-field-label ag-label ag-hidden ag-checkbox-label" aria-hidden="true" role="presentation" id="ag-121-label"></div>
                <div ref="eWrapper" class="ag-wrapper ag-input-wrapper ag-checkbox-input-wrapper" role="presentation">
                    <input ref="eInput" class="ag-input-field-input ag-checkbox-input" type="checkbox" id="ag-121-input" tabindex="-1" aria-label="Press Space to toggle all rows selection (unchecked)">
                </div>
            </div>
            <div ref="eHeaderCompWrapper" class="ag-header-cell-comp-wrapper" role="presentation"><div class="ag-cell-label-container ag-header-cell-sorted-none" role="presentation">
            
            
            <div ref="eLabel" class="ag-header-cell-label" role="presentation">
                <span ref="eText" class="ag-header-cell-text">User_updated</span>
                <span ref="eFilter" class="ag-header-icon ag-header-label-icon ag-filter-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-filter" unselectable="on" role="presentation"></span></span>
                <!--AG-SORT-INDICATOR--><span class="ag-sort-indicator-container" ref="eSortIndicator">
            <span ref="eSortOrder" class="ag-sort-indicator-icon ag-sort-order ag-hidden" aria-hidden="true"></span>
            <span ref="eSortAsc" class="ag-sort-indicator-icon ag-sort-ascending-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-asc" unselectable="on" role="presentation"></span></span>
            <span ref="eSortDesc" class="ag-sort-indicator-icon ag-sort-descending-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-desc" unselectable="on" role="presentation"></span></span>
            <span ref="eSortMixed" class="ag-sort-indicator-icon ag-sort-mixed-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-none" unselectable="on" role="presentation"></span></span>
            <span ref="eSortNone" class="ag-sort-indicator-icon ag-sort-none-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-none" unselectable="on" role="presentation"></span></span>
        </span>
            </div>
        </div></div>
        </div><div class="ag-header-cell ag-header-cell-sortable ag-focus-managed" role="columnheader" col-id="date_updated" aria-colindex="5" tabindex="-1" aria-sort="none" style="top: 0px; height: 48px; width: 200px; left: 800px;">
            <div ref="eResize" class="ag-header-cell-resize" role="presentation" aria-hidden="false"></div><div role="presentation" class="ag-labeled ag-label-align-right ag-checkbox ag-input-field ag-header-select-all ag-hidden" aria-hidden="true">
                <div ref="eLabel" class="ag-input-field-label ag-label ag-hidden ag-checkbox-label" aria-hidden="true" role="presentation" id="ag-125-label"></div>
                <div ref="eWrapper" class="ag-wrapper ag-input-wrapper ag-checkbox-input-wrapper" role="presentation">
                    <input ref="eInput" class="ag-input-field-input ag-checkbox-input" type="checkbox" id="ag-125-input" tabindex="-1" aria-label="Press Space to toggle all rows selection (unchecked)">
                </div>
            </div>
            <div ref="eHeaderCompWrapper" class="ag-header-cell-comp-wrapper" role="presentation"><div class="ag-cell-label-container ag-header-cell-sorted-none" role="presentation">
            
            
            <div ref="eLabel" class="ag-header-cell-label" role="presentation">
                <span ref="eText" class="ag-header-cell-text">Date_updated</span>
                <span ref="eFilter" class="ag-header-icon ag-header-label-icon ag-filter-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-filter" unselectable="on" role="presentation"></span></span>
                <!--AG-SORT-INDICATOR--><span class="ag-sort-indicator-container" ref="eSortIndicator">
            <span ref="eSortOrder" class="ag-sort-indicator-icon ag-sort-order ag-hidden" aria-hidden="true"></span>
            <span ref="eSortAsc" class="ag-sort-indicator-icon ag-sort-ascending-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-asc" unselectable="on" role="presentation"></span></span>
            <span ref="eSortDesc" class="ag-sort-indicator-icon ag-sort-descending-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-desc" unselectable="on" role="presentation"></span></span>
            <span ref="eSortMixed" class="ag-sort-indicator-icon ag-sort-mixed-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-none" unselectable="on" role="presentation"></span></span>
            <span ref="eSortNone" class="ag-sort-indicator-icon ag-sort-none-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-none" unselectable="on" role="presentation"></span></span>
        </span>
            </div>
        </div></div>
        </div><div class="ag-header-cell ag-header-cell-sortable ag-focus-managed" role="columnheader" col-id="guest_id" aria-colindex="6" tabindex="-1" aria-sort="ascending" style="top: 0px; height: 48px; width: 200px; left: 1000px;">
            <div ref="eResize" class="ag-header-cell-resize" role="presentation" aria-hidden="false"></div><div role="presentation" class="ag-labeled ag-label-align-right ag-checkbox ag-input-field ag-header-select-all ag-hidden" aria-hidden="true">
                <div ref="eLabel" class="ag-input-field-label ag-label ag-hidden ag-checkbox-label" aria-hidden="true" role="presentation" id="ag-129-label"></div>
                <div ref="eWrapper" class="ag-wrapper ag-input-wrapper ag-checkbox-input-wrapper" role="presentation">
                    <input ref="eInput" class="ag-input-field-input ag-checkbox-input" type="checkbox" id="ag-129-input" tabindex="-1" aria-label="Press Space to toggle all rows selection (unchecked)">
                </div>
            </div>
            <div ref="eHeaderCompWrapper" class="ag-header-cell-comp-wrapper" role="presentation"><div class="ag-cell-label-container ag-header-cell-sorted-asc" role="presentation">
            
            
            <div ref="eLabel" class="ag-header-cell-label" role="presentation">
                <span ref="eText" class="ag-header-cell-text">Guest_id</span>
                <span ref="eFilter" class="ag-header-icon ag-header-label-icon ag-filter-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-filter" unselectable="on" role="presentation"></span></span>
                <!--AG-SORT-INDICATOR--><span class="ag-sort-indicator-container" ref="eSortIndicator">
            <span ref="eSortOrder" class="ag-sort-indicator-icon ag-sort-order ag-hidden" aria-hidden="true">1</span>
            <span ref="eSortAsc" class="ag-sort-indicator-icon ag-sort-ascending-icon" aria-hidden="true"><span class="ag-icon ag-icon-asc" unselectable="on" role="presentation"></span></span>
            <span ref="eSortDesc" class="ag-sort-indicator-icon ag-sort-descending-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-desc" unselectable="on" role="presentation"></span></span>
            <span ref="eSortMixed" class="ag-sort-indicator-icon ag-sort-mixed-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-none" unselectable="on" role="presentation"></span></span>
            <span ref="eSortNone" class="ag-sort-indicator-icon ag-sort-none-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-none" unselectable="on" role="presentation"></span></span>
        </span>
            </div>
        </div></div>
        </div><div class="ag-header-cell ag-header-cell-sortable ag-focus-managed" role="columnheader" col-id="bed_id" aria-colindex="7" tabindex="-1" aria-sort="none" style="top: 0px; height: 48px; width: 200px; left: 1200px;">
            <div ref="eResize" class="ag-header-cell-resize" role="presentation" aria-hidden="false"></div><div role="presentation" class="ag-labeled ag-label-align-right ag-checkbox ag-input-field ag-header-select-all ag-hidden" aria-hidden="true">
                <div ref="eLabel" class="ag-input-field-label ag-label ag-hidden ag-checkbox-label" aria-hidden="true" role="presentation" id="ag-133-label"></div>
                <div ref="eWrapper" class="ag-wrapper ag-input-wrapper ag-checkbox-input-wrapper" role="presentation">
                    <input ref="eInput" class="ag-input-field-input ag-checkbox-input" type="checkbox" id="ag-133-input" tabindex="-1" aria-label="Press Space to toggle all rows selection (unchecked)">
                </div>
            </div>
            <div ref="eHeaderCompWrapper" class="ag-header-cell-comp-wrapper" role="presentation"><div class="ag-cell-label-container ag-header-cell-sorted-none" role="presentation">
            
            
            <div ref="eLabel" class="ag-header-cell-label" role="presentation">
                <span ref="eText" class="ag-header-cell-text">Bed_id</span>
                <span ref="eFilter" class="ag-header-icon ag-header-label-icon ag-filter-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-filter" unselectable="on" role="presentation"></span></span>
                <!--AG-SORT-INDICATOR--><span class="ag-sort-indicator-container" ref="eSortIndicator">
            <span ref="eSortOrder" class="ag-sort-indicator-icon ag-sort-order ag-hidden" aria-hidden="true"></span>
            <span ref="eSortAsc" class="ag-sort-indicator-icon ag-sort-ascending-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-asc" unselectable="on" role="presentation"></span></span>
            <span ref="eSortDesc" class="ag-sort-indicator-icon ag-sort-descending-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-desc" unselectable="on" role="presentation"></span></span>
            <span ref="eSortMixed" class="ag-sort-indicator-icon ag-sort-mixed-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-none" unselectable="on" role="presentation"></span></span>
            <span ref="eSortNone" class="ag-sort-indicator-icon ag-sort-none-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-none" unselectable="on" role="presentation"></span></span>
        </span>
            </div>
        </div></div>
        </div><div class="ag-header-cell ag-header-cell-sortable ag-focus-managed" role="columnheader" col-id="checkin_date" aria-colindex="8" tabindex="-1" aria-sort="none" style="top: 0px; height: 48px; width: 200px; left: 1400px;">
            <div ref="eResize" class="ag-header-cell-resize" role="presentation" aria-hidden="false"></div><div role="presentation" class="ag-labeled ag-label-align-right ag-checkbox ag-input-field ag-header-select-all ag-hidden" aria-hidden="true">
                <div ref="eLabel" class="ag-input-field-label ag-label ag-hidden ag-checkbox-label" aria-hidden="true" role="presentation" id="ag-137-label"></div>
                <div ref="eWrapper" class="ag-wrapper ag-input-wrapper ag-checkbox-input-wrapper" role="presentation">
                    <input ref="eInput" class="ag-input-field-input ag-checkbox-input" type="checkbox" id="ag-137-input" tabindex="-1" aria-label="Press Space to toggle all rows selection (unchecked)">
                </div>
            </div>
            <div ref="eHeaderCompWrapper" class="ag-header-cell-comp-wrapper" role="presentation"><div class="ag-cell-label-container ag-header-cell-sorted-none" role="presentation">
            
            
            <div ref="eLabel" class="ag-header-cell-label" role="presentation">
                <span ref="eText" class="ag-header-cell-text">Checkin_date</span>
                <span ref="eFilter" class="ag-header-icon ag-header-label-icon ag-filter-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-filter" unselectable="on" role="presentation"></span></span>
                <!--AG-SORT-INDICATOR--><span class="ag-sort-indicator-container" ref="eSortIndicator">
            <span ref="eSortOrder" class="ag-sort-indicator-icon ag-sort-order ag-hidden" aria-hidden="true"></span>
            <span ref="eSortAsc" class="ag-sort-indicator-icon ag-sort-ascending-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-asc" unselectable="on" role="presentation"></span></span>
            <span ref="eSortDesc" class="ag-sort-indicator-icon ag-sort-descending-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-desc" unselectable="on" role="presentation"></span></span>
            <span ref="eSortMixed" class="ag-sort-indicator-icon ag-sort-mixed-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-none" unselectable="on" role="presentation"></span></span>
            <span ref="eSortNone" class="ag-sort-indicator-icon ag-sort-none-icon ag-hidden" aria-hidden="true"><span class="ag-icon ag-icon-none" unselectable="on" role="presentation"></span></span>
        </span>
            </div>
        </div></div>
        </div></div>
`

async function get_table(tableName) {
    res = await axios.get(api+'/items/'+tableName, config);
    let rowData = res.data.data;
    let colNames = Object.keys(rowData[0]);
    let columnDefs = colNames.map(field => { return {field}});
    let gridOptions = { rowData, columnDefs };
    let myGridElement = document.getElementById('bottomdiv');
    myGridElement.innerHTML = '';
    agGrid.createGrid(myGridElement, gridOptions);
}

</script>
 </body>
</html>
